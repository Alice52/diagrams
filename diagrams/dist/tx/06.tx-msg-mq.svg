<svg host="65bd71144e"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="521px" height="431px" viewBox="-0.5 -0.5 521 431" content="&lt;mxfile&gt;&lt;diagram id=&quot;FkSwUqiehlzqS7XZZrdl&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;">
  <defs/>
  <g>
    <path d="M 283 280 L 506.5 280 L 515.5 289 L 515.5 430 L 283 430 L 283 280 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/>
    <path d="M 506.5 280 L 506.5 289 L 515.5 289" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 231px; height: 1px; padding-top: 355px; margin-left: 285px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: left; ">
              <div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: #666600; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
                <div>
                  <span style="font-size: 10px">
                                        1. 半消息发送成功则执行本地事务
                  </span>
                </div>
                <span style="font-size: 10px">
                                    - TL#
                </span>
                <span style="font-size: 10px">
                                    executeLocalTransaction: 这里加一张事务表, 以备回查(XID放入msg)
                </span>
                <div>
                  <span style="font-size: 10px">
                                        2. mq 不知道是否消费则检查事务状态
                  </span>
                </div>
                <div>
                  <span style="font-size: 10px">
                                        - TL#checkLocalTransaction
                  </span>
                </div>
                <div>
                  <span style="font-size: 10px">
                                        3. 消息状态
                  </span>
                </div>
                <div>
                  <span style="font-size: 10px">
                                        - COMMIT_MESSAGE
                  </span>
                </div>
                <div>
                  <span style="font-size: 10px">
                                        - ROOLBACK_MESSAGE
                  </span>
                </div>
                <div>
                  <span style="font-size: 10px">
                                        - UNKNOW
                  </span>
                </div>
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="285" y="359" fill="#666600" font-family="Helvetica" font-size="14px">
                    1. 半消息发送成功则执行本地事务   - TL#executeLocalTransactio...
        </text>
      </switch>
    </g>
    <rect x="0.5" y="0" width="520" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 518px; height: 1px; padding-top: 30px; margin-left: 2px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
                                分布式事务解决方案-事务消息
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="261" y="34" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    分布式事务解决方案-事务消息
        </text>
      </switch>
    </g>
    <path d="M 58 250 L 58.03 215 Q 58.03 205 68.03 205 L 206.63 205" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/>
    <path d="M 211.88 205 L 204.88 208.5 L 206.63 205 L 204.88 201.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 205px; margin-left: 119px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">
                                1. 发送半消息
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="119" y="209" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">
                    1. 发送半消息
        </text>
      </switch>
    </g>
    <path d="M 58 280 L 58 333.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/>
    <path d="M 58 338.88 L 54.5 331.88 L 58 333.63 L 61.5 331.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 304px; margin-left: 58px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">
                                3. 执行本地业务
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="58" y="307" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">
                    3. 执行本地业务
        </text>
      </switch>
    </g>
    <rect x="13" y="250" width="90" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 265px; margin-left: 14px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
                                订单服务
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="58" y="269" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    订单服务
        </text>
      </switch>
    </g>
    <path d="M 235.5 220 L 235.49 247.48 Q 235.48 257.48 225.48 257.48 L 109.37 257.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/>
    <path d="M 104.12 257.5 L 111.12 254 L 109.37 257.5 L 111.12 261 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 258px; margin-left: 174px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">
                                2. 返回发送结果
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="174" y="261" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">
                    2. 返回发送结果
        </text>
      </switch>
    </g>
    <rect x="213" y="190" width="90" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 205px; margin-left: 214px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
                                rocketmq
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="258" y="209" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    rocketmq
        </text>
      </switch>
    </g>
    <path d="M 80.5 357.5 L 248.03 357.48 Q 258.03 357.48 258.03 347.48 L 258 226.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/>
    <path d="M 258 221.12 L 261.5 228.12 L 258 226.37 L 254.5 228.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 358px; margin-left: 194px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">
                                4. 发送确认或回滚
                <br/>
                                超时则会触发回查
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="194" y="361" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">
                    4. 发送确认或回滚...
        </text>
      </switch>
    </g>
    <path d="M 35.5 347 C 35.5 337.67 80.5 337.67 80.5 347 L 80.5 368 C 80.5 377.33 35.5 377.33 35.5 368 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/>
    <path d="M 35.5 347 C 35.5 354 80.5 354 80.5 347" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 43px; height: 1px; padding-top: 363px; margin-left: 37px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
                                DB
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="58" y="366" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    DB
        </text>
      </switch>
    </g>
    <path d="M 445.2 240.18 L 445.2 215 Q 445.21 205 435.21 205 L 309.37 205" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/>
    <path d="M 304.12 205 L 311.12 201.5 L 309.37 205 L 311.12 208.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 204px; margin-left: 386px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">
                                5. 消费消息：retry-16
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="386" y="208" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">
                    5. 消费消息：retry-16
        </text>
      </switch>
    </g>
    <rect x="393" y="240" width="90" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 255px; margin-left: 394px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
              <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
                                支付服务
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="438" y="259" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    支付服务
        </text>
      </switch>
    </g>
    <path d="M 80.5 160 L 172.75 160 L 181.75 169 L 181.75 200 L 80.5 200 L 80.5 160 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/>
    <path d="M 172.75 160 L 172.75 169 L 181.75 169" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/>
    <g transform="translate(-0.5 -0.5)">
      <switch>
        <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
          <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 99px; height: 1px; padding-top: 180px; margin-left: 83px;">
            <div style="box-sizing: border-box; font-size: 0; text-align: left; ">
              <div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: #666600; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
                <div>
                  <span style="font-size: 10px">
                                        1. 半消息不能被消费
                  </span>
                </div>
                <div>
                  <span style="font-size: 10px">
                                        2. 通过两个topic实现
                  </span>
                </div>
              </div>
            </div>
          </div>
        </foreignObject>
        <text x="83" y="184" fill="#666600" font-family="Helvetica" font-size="14px">
                    1. 半消息不能被消费...
        </text>
      </switch>
    </g>
  </g>
  <switch>
    <g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/>
    <a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank">
      <text text-anchor="middle" font-size="10px" x="50%" y="100%">
                Viewer does not support full SVG 1.1
      </text>
    </a>
  </switch>
</svg>
